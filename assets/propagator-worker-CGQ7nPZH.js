var ra=Object.defineProperty;var da=(a,o,n)=>o in a?ra(a,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[o]=n;var X2=(a,o,n)=>da(a,typeof o!="symbol"?o+"":o,n);var Z0=Math.PI,h0=Z0*2,i2=Z0/180,ma=1440,ha=398600.8,P0=6378.135,G0=60/Math.sqrt(P0*P0*P0/ha),k2=P0*G0/60,la=1/G0,J0=.001082616,ea=-253881e-11,fa=-165597e-11,K0=ea/J0,M2=2/3;function ga(a,o){for(var n=[31,a%4===0?29:28,31,30,31,30,31,31,30,31,30,31],r=Math.floor(o),d=1,v=0;r>v+n[d-1]&&d<12;)v+=n[d-1],d+=1;var e=d,i=r-v,l=(o-r)*24,t=Math.floor(l);l=(l-t)*60;var p=Math.floor(l),T=(l-p)*60;return{mon:e,day:i,hr:t,minute:p,sec:T}}function L2(a,o,n,r,d,v){var e=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0;return 367*a-Math.floor(7*(a+Math.floor((o+9)/12))*.25)+Math.floor(275*o/9)+n+17210135e-1+((e/6e4+v/60+d)/60+r)/24}function Y2(a,o,n,r,d,v,e){if(a instanceof Date){var i=a;return L2(i.getUTCFullYear(),i.getUTCMonth()+1,i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds(),i.getUTCMilliseconds())}return L2(a,o,n,r,d,v,e)}function B2(a,o){var n=a.e3,r=a.ee2,d=a.peo,v=a.pgho,e=a.pho,i=a.pinco,l=a.plo,t=a.se2,p=a.se3,T=a.sgh2,B=a.sgh3,z=a.sgh4,Q=a.sh2,J=a.sh3,g=a.si2,M=a.si3,F=a.sl2,_=a.sl3,P=a.sl4,s=a.t,h=a.xgh2,D=a.xgh3,w=a.xgh4,y=a.xh2,i0=a.xh3,L=a.xi2,b=a.xi3,a0=a.xl2,K=a.xl3,r0=a.xl4,q=a.zmol,d0=a.zmos,G=o.init,$=o.opsmode,l0=o.ep,V=o.inclp,E=o.nodep,t0=o.argpp,e0=o.mp,x,f,o0,O,H,A,T0,n0,f0,I,X,v0,U,S,j,u,k,N,c,C,W,x0=119459e-10,g0=.01675,p0=.00015835218,M0=.0549;W=d0+x0*s,G==="y"&&(W=d0),C=W+2*g0*Math.sin(W),k=Math.sin(C),I=.5*k*k-.25,X=-.5*k*Math.cos(C);var F0=t*I+p*X,_0=g*I+M*X,u0=F*I+_*X+P*k,R=T*I+B*X+z*k,s0=Q*I+J*X;W=q+p0*s,G==="y"&&(W=q),C=W+2*M0*Math.sin(W),k=Math.sin(C),I=.5*k*k-.25,X=-.5*k*Math.cos(C);var k0=r*I+n*X,Z=L*I+b*X,z0=a0*I+K*X+r0*k,L0=h*I+D*X+w*k,w0=y*I+i0*X;return v0=F0+k0,j=_0+Z,u=u0+z0,U=R+L0,S=s0+w0,G==="n"&&(v0-=d,j-=i,u-=l,U-=v,S-=e,V+=j,l0+=v0,O=Math.sin(V),o0=Math.cos(V),V>=.2?(S/=O,U-=o0*S,t0+=U,E+=S,e0+=u):(A=Math.sin(E),H=Math.cos(E),x=O*A,f=O*H,T0=S*H+j*o0*A,n0=-S*A+j*o0*H,x+=T0,f+=n0,E%=h0,E<0&&$==="a"&&(E+=h0),N=e0+t0+o0*E,f0=u+U-j*E*O,N+=f0,c=E,E=Math.atan2(x,f),E<0&&$==="a"&&(E+=h0),Math.abs(c-E)>Z0&&(E<c?E+=h0:E-=h0),e0+=u,t0=N-e0-o0*E)),{ep:l0,inclp:V,nodep:E,argpp:t0,mp:e0}}function xa(a){var o=a.epoch,n=a.ep,r=a.argpp,d=a.tc,v=a.inclp,e=a.nodep,i=a.np,l,t,p,T,B,z,Q,J,g,M,F,_,P,s,h,D,w,y,i0,L,b,a0,K,r0,q,d0,G,$,l0,V,E,t0,e0,x,f,o0,O,H,A,T0,n0,f0,I,X,v0,U,S,j,u,k,N,c,C,W,x0,g0,p0,M0,F0,_0,u0,R,s0,k0=.01675,Z=.0549,z0=29864797e-13,L0=47968065e-14,w0=.39785416,q0=.91744867,V0=.1945905,O0=-.98088458,$0=i,j0=n,C0=Math.sin(e),X0=Math.cos(e),E0=Math.sin(r),S0=Math.cos(r),N0=Math.sin(v),m=Math.cos(v),b0=j0*j0,A0=1-b0,W0=Math.sqrt(A0),Y=0,r2=0,c0=0,d2=0,m2=0,B0=o+18261.5+d/1440,D0=(4.523602-.00092422029*B0)%h0,y0=Math.sin(D0),Y0=Math.cos(D0),R0=.91375164-.03568096*Y0,a2=Math.sqrt(1-R0*R0),I0=.089683511*y0/a2,U0=Math.sqrt(1-I0*I0),m0=5.8351514+.001944368*B0,H0=.39785416*y0/a2,s2=U0*Y0+.91744867*I0*y0;H0=Math.atan2(H0,s2),H0+=m0-D0;var y2=Math.cos(H0),u2=Math.sin(H0);L=V0,b=O0,r0=q0,q=w0,a0=X0,K=C0,F=z0;for(var b2=1/$0,h2=0;h2<2;)h2+=1,l=L*a0+b*r0*K,p=-b*a0+L*r0*K,Q=-L*K+b*r0*a0,J=b*q,g=b*K+L*r0*a0,M=L*q,t=m*Q+N0*J,T=m*g+N0*M,B=-N0*Q+m*J,z=-N0*g+m*M,_=l*S0+t*E0,P=p*S0+T*E0,s=-l*E0+t*S0,h=-p*E0+T*S0,D=B*E0,w=z*E0,y=B*S0,i0=z*S0,u0=12*_*_-3*s*s,R=24*_*P-6*s*h,s0=12*P*P-3*h*h,c=3*(l*l+t*t)+u0*b0,C=6*(l*p+t*T)+R*b0,W=3*(p*p+T*T)+s0*b0,x0=-6*l*B+b0*(-24*_*y-6*s*D),g0=-6*(l*z+p*B)+b0*(-24*(P*y+_*i0)+-6*(s*w+h*D)),p0=-6*p*z+b0*(-24*P*i0-6*h*w),M0=6*t*B+b0*(24*_*D-6*s*y),F0=6*(T*B+t*z)+b0*(24*(P*D+_*w)-6*(h*y+s*i0)),_0=6*T*z+b0*(24*P*w-6*h*i0),c=c+c+A0*u0,C=C+C+A0*R,W=W+W+A0*s0,S=F*b2,U=-.5*S/W0,j=S*W0,v0=-15*j0*j,u=_*s+P*h,k=P*s+_*h,N=P*h-_*s,h2===1&&(d0=v0,G=U,$=S,l0=j,V=u,E=k,t0=N,e0=c,x=C,f=W,o0=x0,O=g0,H=p0,A=M0,T0=F0,n0=_0,f0=u0,I=R,X=s0,L=y2,b=u2,r0=R0,q=a2,a0=U0*X0+I0*C0,K=C0*U0-X0*I0,F=L0);var l2=(4.7199672+(.2299715*B0-m0))%h0,q2=(6.2565837+.017201977*B0)%h0,E2=2*d0*E,o2=2*d0*t0,e2=2*G*O,T2=2*G*(H-o0),w2=-2*$*x,S2=-2*$*(f-e0),A2=-2*$*(-21-9*b0)*k0,n2=2*l0*I,I2=2*l0*(X-f0),U2=-18*l0*k0,f2=-2*G*T0,p2=-2*G*(n0-A),g2=2*v0*k,F2=2*v0*N,_2=2*U*g0,J2=2*U*(p0-x0),K2=-2*S*C,c2=-2*S*(W-c),R2=-2*S*(-21-9*b0)*Z,aa=2*j*R,oa=2*j*(s0-u0),na=-18*j*Z,va=-2*U*F0,ia=-2*U*(_0-M0);return{snodm:C0,cnodm:X0,sinim:N0,cosim:m,sinomm:E0,cosomm:S0,day:B0,e3:F2,ee2:g2,em:j0,emsq:b0,gam:m0,peo:Y,pgho:d2,pho:m2,pinco:r2,plo:c0,rtemsq:W0,se2:E2,se3:o2,sgh2:n2,sgh3:I2,sgh4:U2,sh2:f2,sh3:p2,si2:e2,si3:T2,sl2:w2,sl3:S2,sl4:A2,s1:v0,s2:U,s3:S,s4:j,s5:u,s6:k,s7:N,ss1:d0,ss2:G,ss3:$,ss4:l0,ss5:V,ss6:E,ss7:t0,sz1:e0,sz2:x,sz3:f,sz11:o0,sz12:O,sz13:H,sz21:A,sz22:T0,sz23:n0,sz31:f0,sz32:I,sz33:X,xgh2:aa,xgh3:oa,xgh4:na,xh2:va,xh3:ia,xi2:_2,xi3:J2,xl2:K2,xl3:c2,xl4:R2,nm:$0,z1:c,z2:C,z3:W,z11:x0,z12:g0,z13:p0,z21:M0,z22:F0,z23:_0,z31:u0,z32:R,z33:s0,zmol:l2,zmos:q2}}function pa(a){var o=a.cosim,n=a.argpo,r=a.s1,d=a.s2,v=a.s3,e=a.s4,i=a.s5,l=a.sinim,t=a.ss1,p=a.ss2,T=a.ss3,B=a.ss4,z=a.ss5,Q=a.sz1,J=a.sz3,g=a.sz11,M=a.sz13,F=a.sz21,_=a.sz23,P=a.sz31,s=a.sz33,h=a.t,D=a.tc,w=a.gsto,y=a.mo,i0=a.mdot,L=a.no,b=a.nodeo,a0=a.nodedot,K=a.xpidot,r0=a.z1,q=a.z3,d0=a.z11,G=a.z13,$=a.z21,l0=a.z23,V=a.z31,E=a.z33,t0=a.ecco,e0=a.eccsq,x=a.emsq,f=a.em,o0=a.argpm,O=a.inclm,H=a.mm,A=a.nm,T0=a.nodem,n0=a.irez,f0=a.atime,I=a.d2201,X=a.d2211,v0=a.d3210,U=a.d3222,S=a.d4410,j=a.d4422,u=a.d5220,k=a.d5232,N=a.d5421,c=a.d5433,C=a.dedt,W=a.didt,x0=a.dmdt,g0=a.dnodt,p0=a.domdt,M0=a.del1,F0=a.del2,_0=a.del3,u0=a.xfact,R=a.xlamo,s0=a.xli,k0=a.xni,Z,z0,L0,w0,q0,V0,O0,$0,j0,C0,X0,E0,S0,N0,m,b0,A0,W0,Y,r2,c0,d2,m2,B0,D0,y0,Y0,R0,a2,I0,U0,m0,H0=17891679e-13,s2=21460748e-13,y2=22123015e-14,u2=17891679e-13,b2=73636953e-16,h2=21765803e-16,l2=.0043752690880113,q2=37393792e-14,E2=11428639e-14,o2=.00015835218,e2=119459e-10;n0=0,A<.0052359877&&A>.0034906585&&(n0=1),A>=.00826&&A<=.00924&&f>=.5&&(n0=2);var T2=t*e2*z,w2=p*e2*(g+M),S2=-119459e-10*T*(Q+J-14-6*x),A2=B*e2*(P+s-6),n2=-119459e-10*p*(F+_);(O<.052359877||O>Z0-.052359877)&&(n2=0),l!==0&&(n2/=l);var I2=A2-o*n2;C=T2+r*o2*i,W=w2+d*o2*(d0+G),x0=S2-o2*v*(r0+q-14-6*x);var U2=e*o2*(V+E-6),f2=-.00015835218*d*($+l0);(O<.052359877||O>Z0-.052359877)&&(f2=0),p0=I2+U2,g0=n2,l!==0&&(p0-=o/l*f2,g0+=f2/l);var p2=0,g2=(w+D*l2)%h0;if(f+=C*h,O+=W*h,o0+=p0*h,T0+=g0*h,H+=x0*h,n0!==0){if(I0=Math.pow(A/G0,M2),n0===2){U0=o*o;var F2=f;f=t0;var _2=x;x=e0,m0=f*x,N0=-.306-(f-.64)*.44,f<=.65?(m=3.616-13.247*f+16.29*x,A0=-19.302+117.39*f-228.419*x+156.591*m0,W0=-18.9068+109.7927*f-214.6334*x+146.5816*m0,Y=-41.122+242.694*f-471.094*x+313.953*m0,r2=-146.407+841.88*f-1629.014*x+1083.435*m0,c0=-532.114+3017.977*f-5740.032*x+3708.276*m0):(m=-72.099+331.819*f-508.738*x+266.724*m0,A0=-346.844+1582.851*f-2415.925*x+1246.113*m0,W0=-342.585+1554.908*f-2366.899*x+1215.972*m0,Y=-1052.797+4758.686*f-7193.992*x+3651.957*m0,r2=-3581.69+16178.11*f-24462.77*x+12422.52*m0,f>.715?c0=-5149.66+29936.92*f-54087.36*x+31324.56*m0:c0=1464.74-4664.75*f+3763.64*x),f<.7?(B0=-919.2277+4988.61*f-9064.77*x+5542.21*m0,d2=-822.71072+4568.6173*f-8491.4146*x+5337.524*m0,m2=-853.666+4690.25*f-8624.77*x+5341.4*m0):(B0=-37995.78+161616.52*f-229838.2*x+109377.94*m0,d2=-51752.104+218913.95*f-309468.16*x+146349.42*m0,m2=-40023.88+170470.89*f-242699.48*x+115605.82*m0),D0=l*l,Z=.75*(1+2*o+U0),z0=1.5*D0,w0=1.875*l*(1-2*o-3*U0),q0=-1.875*l*(1+2*o-3*U0),O0=35*D0*Z,$0=39.375*D0*D0,j0=9.84375*l*(D0*(1-2*o-5*U0)+.33333333*(-2+4*o+6*U0)),C0=l*(4.92187512*D0*(-2-4*o+10*U0)+6.56250012*(1+2*o-3*U0)),X0=29.53125*l*(2-8*o+U0*(-12+8*o+10*U0)),E0=29.53125*l*(-2-8*o+U0*(12+8*o-10*U0)),R0=A*A,a2=I0*I0,Y0=3*R0*a2,y0=Y0*u2,I=y0*Z*N0,X=y0*z0*m,Y0*=I0,y0=Y0*q2,v0=y0*w0*A0,U=y0*q0*W0,Y0*=I0,y0=2*Y0*b2,S=y0*O0*Y,j=y0*$0*r2,Y0*=I0,y0=Y0*E2,u=y0*j0*c0,k=y0*C0*m2,y0=2*Y0*h2,N=y0*X0*d2,c=y0*E0*B0,R=(y+b+b-(g2+g2))%h0,u0=i0+x0+2*(a0+g0-l2)-L,f=F2,x=_2}n0===1&&(S0=1+x*(-2.5+.8125*x),A0=1+2*x,b0=1+x*(-6+6.60937*x),Z=.75*(1+o)*(1+o),L0=.9375*l*l*(1+3*o)-.75*(1+o),V0=1+o,V0*=1.875*V0*V0,M0=3*A*A*I0*I0,F0=2*M0*Z*S0*H0,_0=3*M0*V0*b0*y2*I0,M0=M0*L0*A0*s2*I0,R=(y+b+n-g2)%h0,u0=i0+K+x0+p0+g0-(L+l2)),s0=R,k0=L,f0=0,A=L+p2}return{em:f,argpm:o0,inclm:O,mm:H,nm:A,nodem:T0,irez:n0,atime:f0,d2201:I,d2211:X,d3210:v0,d3222:U,d4410:S,d4422:j,d5220:u,d5232:k,d5421:N,d5433:c,dedt:C,didt:W,dmdt:x0,dndt:p2,dnodt:g0,domdt:p0,del1:M0,del2:F0,del3:_0,xfact:u0,xlamo:R,xli:s0,xni:k0}}function D2(a){var o=(a-2451545)/36525,n=-62e-7*o*o*o+.093104*o*o+(876600*3600+8640184812866e-6)*o+67310.54841;return n=n*i2/240%h0,n<0&&(n+=h0),n}function G2(){return(arguments.length<=0?void 0:arguments[0])instanceof Date||arguments.length>1?D2(Y2.apply(void 0,arguments)):D2.apply(void 0,arguments)}function za(a){var o=a.ecco,n=a.epoch,r=a.inclo,d=a.opsmode,v=a.no,e=o*o,i=1-e,l=Math.sqrt(i),t=Math.cos(r),p=t*t,T=Math.pow(G0/v,M2),B=.75*J0*(3*p-1)/(l*i),z=B/(T*T),Q=T*(1-z*z-z*(1/3+134*z*z/81));z=B/(Q*Q),v/=1+z;var J=Math.pow(G0/v,M2),g=Math.sin(r),M=J*i,F=1-5*p,_=-F-p-p,P=1/J,s=M*M,h=J*(1-o),D="n",w;if(d==="a"){var y=n-7305,i0=Math.floor(y+1e-8),L=y-i0,b=.017202791694070362,a0=1.7321343856509375,K=5075514194322695e-30,r0=b+h0;w=(a0+b*i0+r0*L+y*y*K)%h0,w<0&&(w+=h0)}else w=G2(n+24332815e-1);return{no:v,method:D,ainv:P,ao:J,con41:_,con42:F,cosio:t,cosio2:p,eccsq:e,omeosq:i,posq:s,rp:h,rteosq:l,sinio:g,gsto:w}}function ta(a){var o=a.irez,n=a.d2201,r=a.d2211,d=a.d3210,v=a.d3222,e=a.d4410,i=a.d4422,l=a.d5220,t=a.d5232,p=a.d5421,T=a.d5433,B=a.dedt,z=a.del1,Q=a.del2,J=a.del3,g=a.didt,M=a.dmdt,F=a.dnodt,_=a.domdt,P=a.argpo,s=a.argpdot,h=a.t,D=a.tc,w=a.gsto,y=a.xfact,i0=a.xlamo,L=a.no,b=a.atime,a0=a.em,K=a.argpm,r0=a.inclm,q=a.xli,d0=a.mm,G=a.xni,$=a.nodem,l0=a.nm,V=.13130908,E=2.8843198,t0=.37448087,e0=5.7686396,x=.95240898,f=1.8014998,o0=1.050833,O=4.4108898,H=.0043752690880113,A=720,T0=-720,n0=259200,f0,I,X,v0,U,S,j,u,k=0,N=0,c=(w+D*H)%h0;if(a0+=B*h,r0+=g*h,K+=_*h,$+=F*h,d0+=M*h,o!==0){(b===0||h*b<=0||Math.abs(h)<Math.abs(b))&&(b=0,G=L,q=i0),h>0?f0=A:f0=T0;for(var C=381;C===381;)o!==2?(j=z*Math.sin(q-V)+Q*Math.sin(2*(q-E))+J*Math.sin(3*(q-t0)),U=G+y,S=z*Math.cos(q-V)+2*Q*Math.cos(2*(q-E))+3*J*Math.cos(3*(q-t0)),S*=U):(u=P+s*b,X=u+u,I=q+q,j=n*Math.sin(X+q-e0)+r*Math.sin(q-e0)+d*Math.sin(u+q-x)+v*Math.sin(-u+q-x)+e*Math.sin(X+I-f)+i*Math.sin(I-f)+l*Math.sin(u+q-o0)+t*Math.sin(-u+q-o0)+p*Math.sin(u+I-O)+T*Math.sin(-u+I-O),U=G+y,S=n*Math.cos(X+q-e0)+r*Math.cos(q-e0)+d*Math.cos(u+q-x)+v*Math.cos(-u+q-x)+l*Math.cos(u+q-o0)+t*Math.cos(-u+q-o0)+2*(e*Math.cos(X+I-f)+i*Math.cos(I-f)+p*Math.cos(u+I-O)+T*Math.cos(-u+I-O)),S*=U),Math.abs(h-b)>=A?C=381:(N=h-b,C=0),C===381&&(q+=U*f0+j*n0,G+=j*f0+S*n0,b+=f0);l0=G+j*N+S*N*N*.5,v0=q+U*N+j*N*N*.5,o!==1?(d0=v0-2*$+2*c,k=l0-L):(d0=v0-$-K+c,k=l0-L),l0=L+k}return{atime:b,em:a0,argpm:K,inclm:r0,xli:q,mm:d0,xni:G,nodem:$,dndt:k,nm:l0}}function H2(a,o){var n,r,d,v,e,i,l,t,p,T,B,z,Q,J,g,M,F,_,P,s,h,D,w,y,i0,L,b,a0=15e-13;a.t=o,a.error=0;var K=a.mo+a.mdot*a.t,r0=a.argpo+a.argpdot*a.t,q=a.nodeo+a.nodedot*a.t;p=r0,h=K;var d0=a.t*a.t;if(w=q+a.nodecf*d0,F=1-a.cc1*a.t,_=a.bstar*a.cc4*a.t,P=a.t2cof*d0,a.isimp!==1){l=a.omgcof*a.t;var G=1+a.eta*Math.cos(K);i=a.xmcof*(G*G*G-a.delmo),M=l+i,h=K+M,p=r0-M,z=d0*a.t,Q=z*a.t,F=F-a.d2*d0-a.d3*z-a.d4*Q,_+=a.bstar*a.cc5*(Math.sin(h)-a.sinmao),P=P+a.t3cof*z+Q*(a.t4cof+a.t*a.t5cof)}D=a.no;var $=a.ecco;if(s=a.inclo,a.method==="d"){J=a.t;var l0={irez:a.irez,d2201:a.d2201,d2211:a.d2211,d3210:a.d3210,d3222:a.d3222,d4410:a.d4410,d4422:a.d4422,d5220:a.d5220,d5232:a.d5232,d5421:a.d5421,d5433:a.d5433,dedt:a.dedt,del1:a.del1,del2:a.del2,del3:a.del3,didt:a.didt,dmdt:a.dmdt,dnodt:a.dnodt,domdt:a.domdt,argpo:a.argpo,argpdot:a.argpdot,t:a.t,tc:J,gsto:a.gsto,xfact:a.xfact,xlamo:a.xlamo,no:a.no,atime:a.atime,em:$,argpm:p,inclm:s,xli:a.xli,mm:h,xni:a.xni,nodem:w,nm:D},V=ta(l0);$=V.em,p=V.argpm,s=V.inclm,h=V.mm,w=V.nodem,D=V.nm}if(D<=0)return a.error=2,[!1,!1];var E=Math.pow(G0/D,M2)*F*F;if(D=G0/Math.pow(E,1.5),$-=_,$>=1||$<-.001)return a.error=1,[!1,!1];$<1e-6&&($=1e-6),h+=a.no*P,i0=h+p+w,w%=h0,p%=h0,i0%=h0,h=(i0-p-w)%h0;var t0={am:E,em:$,im:s,Om:w,om:p,mm:h,nm:D},e0=Math.sin(s),x=Math.cos(s),f=$;if(y=s,T=p,b=w,L=h,v=e0,d=x,a.method==="d"){var o0={inclo:a.inclo,init:"n",ep:f,inclp:y,nodep:b,argpp:T,mp:L,opsmode:a.operationmode},O=B2(a,o0);if(f=O.ep,b=O.nodep,T=O.argpp,L=O.mp,y=O.inclp,y<0&&(y=-y,b+=Z0,T-=Z0),f<0||f>1)return a.error=3,[!1,!1]}a.method==="d"&&(v=Math.sin(y),d=Math.cos(y),a.aycof=-.5*K0*v,Math.abs(d+1)>15e-13?a.xlcof=-.25*K0*v*(3+5*d)/(1+d):a.xlcof=-.25*K0*v*(3+5*d)/a0);var H=f*Math.cos(T);M=1/(E*(1-f*f));var A=f*Math.sin(T)+M*a.aycof,T0=L+T+b+M*a.xlcof*H,n0=(T0-b)%h0;t=n0,g=9999.9;for(var f0=1;Math.abs(g)>=1e-12&&f0<=10;)r=Math.sin(t),n=Math.cos(t),g=1-n*H-r*A,g=(n0-A*n+H*r-t)/g,Math.abs(g)>=.95&&(g>0?g=.95:g=-.95),t+=g,f0+=1;var I=H*n+A*r,X=H*r-A*n,v0=H*H+A*A,U=E*(1-v0);if(U<0)return a.error=4,[!1,!1];var S=E*(1-I),j=Math.sqrt(E)*X/S,u=Math.sqrt(U)/S,k=Math.sqrt(1-v0);M=X/(1+k);var N=E/S*(r-A-H*M),c=E/S*(n-H+A*M);B=Math.atan2(N,c);var C=(c+c)*N,W=1-2*N*N;M=1/U;var x0=.5*J0*M,g0=x0*M;a.method==="d"&&(e=d*d,a.con41=3*e-1,a.x1mth2=1-e,a.x7thm1=7*e-1);var p0=S*(1-1.5*g0*k*a.con41)+.5*x0*a.x1mth2*W;if(p0<1)return a.error=6,{position:!1,velocity:!1,meanElements:t0};B-=.25*g0*a.x7thm1*C;var M0=b+1.5*g0*d*C,F0=y+1.5*g0*d*v*W,_0=j-D*x0*a.x1mth2*C/G0,u0=u+D*x0*(a.x1mth2*W+1.5*a.con41)/G0,R=Math.sin(B),s0=Math.cos(B),k0=Math.sin(M0),Z=Math.cos(M0),z0=Math.sin(F0),L0=Math.cos(F0),w0=-k0*L0,q0=Z*L0,V0=w0*R+Z*s0,O0=q0*R+k0*s0,$0=z0*R,j0=w0*s0-Z*R,C0=q0*s0-k0*R,X0=z0*s0,E0={x:p0*V0*P0,y:p0*O0*P0,z:p0*$0*P0},S0={x:(_0*V0+u0*j0)*k2,y:(_0*O0+u0*C0)*k2,z:(_0*$0+u0*X0)*k2};return{position:E0,velocity:S0,meanElements:t0}}function Ma(a,o){var n=o.opsmode,r=o.epoch,d=o.xbstar,v=o.xecco,e=o.xargpo,i=o.xinclo,l=o.xmo,t=o.xno,p=o.xnodeo,T,B,z,Q,J,g,M,F,_,P,s,h,D,w,y,i0,L,b,a0,K,r0,q,d0,G,$,l0,V,E,t0,e0,x,f,o0,O,H,A,T0,n0,f0,I,X,v0,U,S,j,u,k,N,c,C,W,x0,g0,p0,M0,F0,_0=15e-13;a.isimp=0,a.method="n",a.aycof=0,a.con41=0,a.cc1=0,a.cc4=0,a.cc5=0,a.d2=0,a.d3=0,a.d4=0,a.delmo=0,a.eta=0,a.argpdot=0,a.omgcof=0,a.sinmao=0,a.t=0,a.t2cof=0,a.t3cof=0,a.t4cof=0,a.t5cof=0,a.x1mth2=0,a.x7thm1=0,a.mdot=0,a.nodedot=0,a.xlcof=0,a.xmcof=0,a.nodecf=0,a.irez=0,a.d2201=0,a.d2211=0,a.d3210=0,a.d3222=0,a.d4410=0,a.d4422=0,a.d5220=0,a.d5232=0,a.d5421=0,a.d5433=0,a.dedt=0,a.del1=0,a.del2=0,a.del3=0,a.didt=0,a.dmdt=0,a.dnodt=0,a.domdt=0,a.e3=0,a.ee2=0,a.peo=0,a.pgho=0,a.pho=0,a.pinco=0,a.plo=0,a.se2=0,a.se3=0,a.sgh2=0,a.sgh3=0,a.sgh4=0,a.sh2=0,a.sh3=0,a.si2=0,a.si3=0,a.sl2=0,a.sl3=0,a.sl4=0,a.gsto=0,a.xfact=0,a.xgh2=0,a.xgh3=0,a.xgh4=0,a.xh2=0,a.xh3=0,a.xi2=0,a.xi3=0,a.xl2=0,a.xl3=0,a.xl4=0,a.xlamo=0,a.zmol=0,a.zmos=0,a.atime=0,a.xli=0,a.xni=0,a.bstar=d,a.ecco=v,a.argpo=e,a.inclo=i,a.mo=l,a.no=t,a.nodeo=p,a.operationmode=n;var u0=78/P0+1,R=42/P0,s0=R*R*R*R;a.init="y",a.t=0;var k0={ecco:a.ecco,epoch:r,inclo:a.inclo,no:a.no,method:a.method,opsmode:a.operationmode},Z=za(k0),z0=Z.ao,L0=Z.con42,w0=Z.cosio,q0=Z.cosio2,V0=Z.eccsq,O0=Z.omeosq,$0=Z.posq,j0=Z.rp,C0=Z.rteosq,X0=Z.sinio;if(a.no=Z.no,a.con41=Z.con41,a.gsto=Z.gsto,a.a=Math.pow(a.no*la,-2/3),a.alta=a.a*(1+a.ecco)-1,a.altp=a.a*(1-a.ecco)-1,a.error=0,O0>=0||a.no>=0){if(a.isimp=0,j0<220/P0+1&&(a.isimp=1),V=u0,r0=s0,b=(j0-1)*P0,b<156){V=b-78,b<98&&(V=20);var E0=(120-V)/P0;r0=E0*E0*E0*E0,V=V/P0+1}a0=1/$0,u=1/(z0-V),a.eta=z0*a.ecco*u,h=a.eta*a.eta,s=a.ecco*a.eta,K=Math.abs(1-h),g=r0*Math.pow(u,4),M=g/Math.pow(K,3.5),Q=M*a.no*(z0*(1+1.5*h+s*(4+h))+.375*J0*u/K*a.con41*(8+3*h*(8+h))),a.cc1=a.bstar*Q,J=0,a.ecco>1e-4&&(J=-2*g*u*K0*a.no*X0/a.ecco),a.x1mth2=1-q0,a.cc4=2*a.no*M*z0*O0*(a.eta*(2+.5*h)+a.ecco*(.5+2*h)-J0*u/(z0*K)*(-3*a.con41*(1-2*s+h*(1.5-.5*s))+.75*a.x1mth2*(2*h-s*(1+h))*Math.cos(2*a.argpo))),a.cc5=2*M*z0*O0*(1+2.75*(h+s)+s*h),F=q0*q0,U=1.5*J0*a0*a.no,S=.5*U*J0*a0,j=-.46875*fa*a0*a0*a.no,a.mdot=a.no+.5*U*C0*a.con41+.0625*S*C0*(13-78*q0+137*F),a.argpdot=-.5*U*L0+.0625*S*(7-114*q0+395*F)+j*(3-36*q0+49*F),N=-U*w0,a.nodedot=N+(.5*S*(4-19*q0)+2*j*(3-7*q0))*w0,k=a.argpdot+a.nodedot,a.omgcof=a.bstar*J*Math.cos(a.argpo),a.xmcof=0,a.ecco>1e-4&&(a.xmcof=-.6666666666666666*g*a.bstar/s),a.nodecf=3.5*O0*N*a.cc1,a.t2cof=1.5*a.cc1,Math.abs(w0+1)>15e-13?a.xlcof=-.25*K0*X0*(3+5*w0)/(1+w0):a.xlcof=-.25*K0*X0*(3+5*w0)/_0,a.aycof=-.5*K0*X0;var S0=1+a.eta*Math.cos(a.mo);if(a.delmo=S0*S0*S0,a.sinmao=Math.sin(a.mo),a.x7thm1=7*q0-1,2*Z0/a.no>=225){a.method="d",a.isimp=1,X=0,y=a.inclo;var N0={epoch:r,ep:a.ecco,argpp:a.argpo,tc:X,inclp:a.inclo,nodep:a.nodeo,np:a.no,e3:a.e3,ee2:a.ee2,peo:a.peo,pgho:a.pgho,pho:a.pho,pinco:a.pinco,plo:a.plo,se2:a.se2,se3:a.se3,sgh2:a.sgh2,sgh3:a.sgh3,sgh4:a.sgh4,sh2:a.sh2,sh3:a.sh3,si2:a.si2,si3:a.si3,sl2:a.sl2,sl3:a.sl3,sl4:a.sl4,xgh2:a.xgh2,xgh3:a.xgh3,xgh4:a.xgh4,xh2:a.xh2,xh3:a.xh3,xi2:a.xi2,xi3:a.xi3,xl2:a.xl2,xl3:a.xl3,xl4:a.xl4,zmol:a.zmol,zmos:a.zmos},m=xa(N0);a.e3=m.e3,a.ee2=m.ee2,a.peo=m.peo,a.pgho=m.pgho,a.pho=m.pho,a.pinco=m.pinco,a.plo=m.plo,a.se2=m.se2,a.se3=m.se3,a.sgh2=m.sgh2,a.sgh3=m.sgh3,a.sgh4=m.sgh4,a.sh2=m.sh2,a.sh3=m.sh3,a.si2=m.si2,a.si3=m.si3,a.sl2=m.sl2,a.sl3=m.sl3,a.sl4=m.sl4,B=m.sinim,T=m.cosim,_=m.em,P=m.emsq,q=m.s1,d0=m.s2,G=m.s3,$=m.s4,l0=m.s5,E=m.ss1,t0=m.ss2,e0=m.ss3,x=m.ss4,f=m.ss5,o0=m.sz1,O=m.sz3,H=m.sz11,A=m.sz13,T0=m.sz21,n0=m.sz23,f0=m.sz31,I=m.sz33,a.xgh2=m.xgh2,a.xgh3=m.xgh3,a.xgh4=m.xgh4,a.xh2=m.xh2,a.xh3=m.xh3,a.xi2=m.xi2,a.xi3=m.xi3,a.xl2=m.xl2,a.xl3=m.xl3,a.xl4=m.xl4,a.zmol=m.zmol,a.zmos=m.zmos,L=m.nm,c=m.z1,C=m.z3,W=m.z11,x0=m.z13,g0=m.z21,p0=m.z23,M0=m.z31,F0=m.z33;var b0={inclo:y,init:a.init,ep:a.ecco,inclp:a.inclo,nodep:a.nodeo,argpp:a.argpo,mp:a.mo,opsmode:a.operationmode},A0=B2(a,b0);a.ecco=A0.ep,a.inclo=A0.inclp,a.nodeo=A0.nodep,a.argpo=A0.argpp,a.mo=A0.mp,D=0,w=0,i0=0;var W0={cosim:T,emsq:P,argpo:a.argpo,s1:q,s2:d0,s3:G,s4:$,s5:l0,sinim:B,ss1:E,ss2:t0,ss3:e0,ss4:x,ss5:f,sz1:o0,sz3:O,sz11:H,sz13:A,sz21:T0,sz23:n0,sz31:f0,sz33:I,t:a.t,tc:X,gsto:a.gsto,mo:a.mo,mdot:a.mdot,no:a.no,nodeo:a.nodeo,nodedot:a.nodedot,xpidot:k,z1:c,z3:C,z11:W,z13:x0,z21:g0,z23:p0,z31:M0,z33:F0,ecco:a.ecco,eccsq:V0,em:_,argpm:D,inclm:y,mm:i0,nm:L,nodem:w,irez:a.irez,atime:a.atime,d2201:a.d2201,d2211:a.d2211,d3210:a.d3210,d3222:a.d3222,d4410:a.d4410,d4422:a.d4422,d5220:a.d5220,d5232:a.d5232,d5421:a.d5421,d5433:a.d5433,dedt:a.dedt,didt:a.didt,dmdt:a.dmdt,dnodt:a.dnodt,domdt:a.domdt,del1:a.del1,del2:a.del2,del3:a.del3,xfact:a.xfact,xlamo:a.xlamo,xli:a.xli,xni:a.xni},Y=pa(W0);a.irez=Y.irez,a.atime=Y.atime,a.d2201=Y.d2201,a.d2211=Y.d2211,a.d3210=Y.d3210,a.d3222=Y.d3222,a.d4410=Y.d4410,a.d4422=Y.d4422,a.d5220=Y.d5220,a.d5232=Y.d5232,a.d5421=Y.d5421,a.d5433=Y.d5433,a.dedt=Y.dedt,a.didt=Y.didt,a.dmdt=Y.dmdt,a.dnodt=Y.dnodt,a.domdt=Y.domdt,a.del1=Y.del1,a.del2=Y.del2,a.del3=Y.del3,a.xfact=Y.xfact,a.xlamo=Y.xlamo,a.xli=Y.xli,a.xni=Y.xni}a.isimp!==1&&(z=a.cc1*a.cc1,a.d2=4*z0*u*z,v0=a.d2*u*a.cc1/3,a.d3=(17*z0+V)*v0,a.d4=.5*v0*z0*u*(221*z0+31*V)*a.cc1,a.t3cof=a.d2+2*z,a.t4cof=.25*(3*a.d3+a.cc1*(12*a.d2+10*z)),a.t5cof=.2*(3*a.d4+12*a.cc1*a.d3+6*a.d2*a.d2+15*z*(2*a.d2+z)))}H2(a,0),a.init="n"}function sa(a,o){var n="i",r=1440/(2*Z0),d=0,v={};v.error=0,v.satnum=a.substring(2,7),v.epochyr=parseInt(a.substring(18,20),10),v.epochdays=parseFloat(a.substring(20,32)),v.ndot=parseFloat(a.substring(33,43)),v.nddot=parseFloat(".".concat(parseInt(a.substring(44,50),10),"E").concat(a.substring(50,52))),v.bstar=parseFloat("".concat(a.substring(53,54),".").concat(parseInt(a.substring(54,59),10),"E").concat(a.substring(59,61))),v.inclo=parseFloat(o.substring(8,16)),v.nodeo=parseFloat(o.substring(17,25)),v.ecco=parseFloat(".".concat(o.substring(26,33))),v.argpo=parseFloat(o.substring(34,42)),v.mo=parseFloat(o.substring(43,51)),v.no=parseFloat(o.substring(52,63)),v.no/=r,v.inclo*=i2,v.nodeo*=i2,v.argpo*=i2,v.mo*=i2,v.epochyr<57?d=v.epochyr+2e3:d=v.epochyr+1900;var e=ga(d,v.epochdays),i=e.mon,l=e.day,t=e.hr,p=e.minute,T=e.sec;return v.jdsatepoch=Y2(d,i,l,t,p,T),Ma(v,{opsmode:n,satn:v.satnum,epoch:v.jdsatepoch-24332815e-1,xbstar:v.bstar,xecco:v.ecco,xargpo:v.argpo,xinclo:v.inclo,xmo:v.mo,xno:v.no,xnodeo:v.nodeo}),v}function C2(a,o){(o==null||o>a.length)&&(o=a.length);for(var n=0,r=Array(o);n<o;n++)r[n]=a[n];return r}function ya(a){if(Array.isArray(a))return C2(a)}function ua(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function ba(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qa(a){return ya(a)||ua(a)||Ea(a)||ba()}function Ea(a,o){if(a){if(typeof a=="string")return C2(a,o);var n={}.toString.call(a).slice(8,-1);return n==="Object"&&a.constructor&&(n=a.constructor.name),n==="Map"||n==="Set"?Array.from(a):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C2(a,o):void 0}}function Ta(){for(var a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];var r=o[0],d=Array.prototype.slice.call(o,1),v=Y2.apply(void 0,qa(d)),e=(v-r.jdsatepoch)*ma;return H2(r,e)}function $2(a){return a*i2}function wa(a){var o=a.longitude,n=a.latitude,r=a.height,d=6378.137,v=6356.7523142,e=(d-v)/d,i=2*e-e*e,l=d/Math.sqrt(1-i*(Math.sin(n)*Math.sin(n))),t=(l+r)*Math.cos(n)*Math.cos(o),p=(l+r)*Math.cos(n)*Math.sin(o),T=(l*(1-i)+r)*Math.sin(n);return{x:t,y:p,z:T}}function Sa(a,o){var n=a.x*Math.cos(o)+a.y*Math.sin(o),r=a.x*-Math.sin(o)+a.y*Math.cos(o),d=a.z;return{x:n,y:r,z:d}}function Aa(a,o){var n=a.longitude,r=a.latitude,d=wa(a),v=o.x-d.x,e=o.y-d.y,i=o.z-d.z,l=Math.sin(r)*Math.cos(n)*v+Math.sin(r)*Math.sin(n)*e-Math.cos(r)*i,t=-Math.sin(n)*v+Math.cos(n)*e,p=Math.cos(r)*Math.cos(n)*v+Math.cos(r)*Math.sin(n)*e+Math.sin(r)*i;return{topS:l,topE:t,topZ:p}}function Ia(a){var o=a.topS,n=a.topE,r=a.topZ,d=Math.sqrt(o*o+n*n+r*r),v=Math.asin(r/d),e=Math.atan2(-n,o)+Z0;return{azimuth:e,elevation:v,rangeSat:d}}function Ua(a,o){var n=Aa(a,o);return Ia(n)}class Fa{constructor(o){X2(this,"charMap",new Map);X2(this,"kerningsMap",new Map);o.chars.forEach(n=>{this.charMap.set(n.char,n)}),o.kernings.forEach(n=>{this.kerningsMap.set(`${n.first},${n.second}`,n.amount)})}textToGeometry(o){return o.split("").map(n=>this.charMap.get(n)??this.charMap.get("?")).reduce((n,r,d,v)=>{let e=0;if(d!==0){const i=v[d-1];e=this.kerningsMap.get(`${i.id},${r.id}`)??0}return n.chars.push({iXY:[n.width+r.xoffset+e,r.yoffset],iUV:[r.x,r.y],iSize:[r.width,r.height]}),n.width+=r.xadvance+e,n},{width:0,chars:[]})}}const Q0=6,Q2=3,v2=2,x2=2,P2=v2+Q2+x2;function _a(a,o){const n=Math.cos(a)*Math.cos(o),r=-Math.cos(a)*Math.sin(o),d=Math.sin(a);return[r,d,n]}function N2(a){const o=a.reduce((d,v)=>d+v.length,0),n=a[0]instanceof Float32Array?new Float32Array(o):new Int32Array(o);let r=0;for(const d of a)n.set(d,r),r+=d.length;return n}function Z2(a,...o){postMessage(a,...o)}let W2=[];const V2=new Map,z2=new Map,O2=new Map,j2=new Map,t2=a=>a/6371,Xa=(a,o)=>{const{meanElements:n}=o;for(const[r,{min:d,max:v,enabled:e}]of Object.entries(a)){if(!e)continue;const i=n.am*(1+n.em)-1,l=n.am*(1-n.em)-1;switch(r){case"inclination_deg":if(n.im<d*(Math.PI/180)||n.im>v*(Math.PI/180))return!1;break;case"eccentricity":if(n.em<d||n.em>v)return!1;break;case"period_minutes":{const t=2*Math.PI/n.nm;if(t<d||t>v)return!1;break}case"apogee_km":if(i<t2(d)||i>t2(v))return!1;break;case"perigee_km":if(l<t2(d)||l>t2(v))return!1}}return!0};self.onmessage=a=>{if(a.data.type==="init"){const o=a.data.ids;if(o.length!==a.data["3LEs"].length)throw new Error("Ids must match 3LEs in length");z2.clear(),O2.clear(),j2.clear(),V2.clear();const n=new Fa(a.data.msdfDefinition);W2=a.data["3LEs"].map((r,d)=>{const v=sa(r[1],r[2]),e=n.textToGeometry(r[0].slice(2));return z2.set(v.satnum,e),O2.set(v.satnum,new Float32Array(e.chars.flatMap(i=>[i.iXY[0],i.iXY[1],i.iXY[0]+i.iSize[0],i.iXY[1],i.iXY[0]+i.iSize[0],i.iXY[1]+i.iSize[1],i.iXY[0],i.iXY[1],i.iXY[0],i.iXY[1]+i.iSize[1],i.iXY[0]+i.iSize[0],i.iXY[1]+i.iSize[1]]))),j2.set(v.satnum,new Float32Array(e.chars.flatMap(i=>[i.iUV[0],i.iUV[1],i.iUV[0]+i.iSize[0],i.iUV[1],i.iUV[0]+i.iSize[0],i.iUV[1]+i.iSize[1],i.iUV[0],i.iUV[1],i.iUV[0],i.iUV[1]+i.iSize[1],i.iUV[0]+i.iSize[0],i.iUV[1]+i.iSize[1]]))),V2.set(v.satnum,o[d]),v}).filter(r=>r.error===0),Z2({type:"init",message:"ok",queryId:a.data.queryId})}else if(a.data.type==="process"){const{date:o,location:n,queryId:r,filter:d}=a.data,v=G2(o),e={longitude:$2(n.longitude),latitude:$2(n.latitude),height:n.altitude/1e3},i=W2.map(g=>{const M=Ta(g,o);return typeof M.position!="object"?null:{positionEci:{position:M.position,velocity:M.velocity,meanElements:M.meanElements},norad:g.satnum}}).filter(g=>!!g).filter(({positionEci:g})=>Xa(d,g)).map(({positionEci:g,norad:M})=>{const F=Sa(g.position,v),_=Ua(e,F);return{norad:M,cartesian:_a(_.elevation,_.azimuth)}}),l=i.filter(g=>g.cartesian).filter(g=>g.cartesian[1]>0),t=N2(l.map(g=>new Float32Array(g.cartesian))),p=N2(l.map(g=>new Int32Array([V2.get(g.norad)]))),T=l.reduce((g,M)=>g+z2.get(M.norad).chars.length,0),B=P2*Q0*T,z=new Float32Array(B),Q=v2,J=Q+Q2;for(let g=0,M=0;g<l.length;g++){const F=l[g],_=z2.get(F.norad),P=O2.get(F.norad),s=j2.get(F.norad);for(let h=0;h<_.chars.length;h++){const D=(M+h)*P2*Q0;for(let w=0;w<Q0;w++){const y=D+w*P2;z[y]=P[h*Q0*v2+w*v2],z[y+1]=P[h*Q0*v2+w*v2+1],z[y+Q]=F.cartesian[0],z[y+Q+1]=F.cartesian[1],z[y+Q+2]=F.cartesian[2],z[y+J]=s[h*Q0*x2+w*x2],z[y+J+1]=s[h*Q0*x2+w*x2+1]}}M+=_.chars.length}Z2({type:"process",result:{failedNorads:i.filter(g=>!g.cartesian).map(g=>g.norad),propagatedPositions:t,propagatedIds:p,texts:z},queryId:r},[t.buffer,z.buffer])}};
