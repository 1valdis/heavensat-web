(()=>{"use strict";var e={51:(e,t,a)=>{var i=a(719);class r{constructor(e){this.charMap=new Map,this.kerningsMap=new Map,e.chars.forEach((e=>{this.charMap.set(e.char,e)})),e.kernings.forEach((e=>{this.kerningsMap.set(`${e.first},${e.second}`,e.amount)}))}textToGeometry(e){return e.split("").map((e=>{var t;return null!==(t=this.charMap.get(e))&&void 0!==t?t:this.charMap.get("?")})).reduce(((e,t,a,i)=>{let r=0;if(0!==a){var n;const e=i[a-1];r=null!==(n=this.kerningsMap.get(`${e.id},${t.id}`))&&void 0!==n?n:0}return e.chars.push({iXY:[e.width+t.xoffset+r,t.yoffset],iUV:[t.x,t.y],iSize:[t.width,t.height]}),e.width+=t.xadvance+r,e}),{width:0,chars:[]})}}function n(e,t){const a=Math.cos(e)*Math.cos(t);return[-Math.cos(e)*Math.sin(t),Math.sin(e),a]}function s(e){const t=e.reduce(((e,t)=>e+t.length),0),a=new Float32Array(t);let i=0;for(const r of e)a.set(r,i),i+=r.length;return a}function o(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),i=1;i<t;i++)a[i-1]=arguments[i];postMessage(e,...a)}let c=[];const l=new Map,h=new Map,p=new Map;self.onmessage=e=>{if("init"===e.data.type){l.clear(),h.clear(),p.clear();const t=new r(e.data.msdfDefinition);c=e.data["3LEs"].map((e=>{const a=i.YX(e[1],e[2]),r=t.textToGeometry(e[0].slice(2));return l.set(a.satnum,r),h.set(a.satnum,new Float32Array(r.chars.flatMap((e=>[e.iXY[0],e.iXY[1],e.iXY[0]+e.iSize[0],e.iXY[1],e.iXY[0]+e.iSize[0],e.iXY[1]+e.iSize[1],e.iXY[0],e.iXY[1],e.iXY[0],e.iXY[1]+e.iSize[1],e.iXY[0]+e.iSize[0],e.iXY[1]+e.iSize[1]])))),p.set(a.satnum,new Float32Array(r.chars.flatMap((e=>[e.iUV[0],e.iUV[1],e.iUV[0]+e.iSize[0],e.iUV[1],e.iUV[0]+e.iSize[0],e.iUV[1]+e.iSize[1],e.iUV[0],e.iUV[1],e.iUV[0],e.iUV[1]+e.iSize[1],e.iUV[0]+e.iSize[0],e.iUV[1]+e.iSize[1]])))),a})).filter((e=>0===e.error)),o({type:"init",message:"ok",queryId:e.data.queryId})}else if("process"===e.data.type){const{date:t,location:a,queryId:r}=e.data,u=i.Ut(t),f={longitude:i.Ht(a.longitude),latitude:i.Ht(a.latitude),height:a.altitude/1e3},d=c.map((e=>{const a=i.a0(e,t);if("object"!==typeof a.position)return{cartesian:null,norad:e.satnum};const r=i.nB(a.position,u),s=i.us(f,r);return{norad:e.satnum,cartesian:n(s.elevation,s.azimuth)}})),g=d.filter((e=>e.cartesian)).filter((e=>e.cartesian[1]>0)),v=new Float32Array(g.flatMap((e=>e.cartesian))),m=s(g.map((e=>Float32Array.from({length:18*l.get(e.norad).chars.length},((t,a)=>e.cartesian[a%3]))))),y=s(g.map((e=>h.get(e.norad)))),w=s(g.map((e=>p.get(e.norad))));o({type:"process",result:{failedNorads:d.filter((e=>!e.cartesian)).map((e=>e.norad)),propagatedPositions:v,textsOrigins:m,textsPositions:y,textsUVCoords:w},queryId:r},[v.buffer,m.buffer,y.buffer,w.buffer])}}}},t={};function a(i){var r=t[i];if(void 0!==r)return r.exports;var n=t[i]={exports:{}};return e[i](n,n.exports,a),n.exports}a.m=e,a.x=()=>{var e=a.O(void 0,[719],(()=>a(51)));return e=a.O(e)},(()=>{var e=[];a.O=(t,i,r,n)=>{if(!i){var s=1/0;for(h=0;h<e.length;h++){for(var[i,r,n]=e[h],o=!0,c=0;c<i.length;c++)(!1&n||s>=n)&&Object.keys(a.O).every((e=>a.O[e](i[c])))?i.splice(c--,1):(o=!1,n<s&&(s=n));if(o){e.splice(h--,1);var l=r();void 0!==l&&(t=l)}}return t}n=n||0;for(var h=e.length;h>0&&e[h-1][2]>n;h--)e[h]=e[h-1];e[h]=[i,r,n]}})(),a.d=(e,t)=>{for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,i)=>(a.f[i](e,t),t)),[])),a.u=e=>"static/js/"+e+".5192082e.chunk.js",a.miniCssF=e=>{},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.p="/heavensat-web/",(()=>{var e={51:1};a.f.i=(t,i)=>{e[t]||importScripts(a.p+a.u(t))};var t=globalThis.webpackChunkheavensat_web=globalThis.webpackChunkheavensat_web||[],i=t.push.bind(t);t.push=t=>{var[r,n,s]=t;for(var o in n)a.o(n,o)&&(a.m[o]=n[o]);for(s&&s(a);r.length;)e[r.pop()]=1;i(t)}})(),(()=>{var e=a.x;a.x=()=>a.e(719).then(e)})();a.x()})();
//# sourceMappingURL=51.ebc07611.chunk.js.map